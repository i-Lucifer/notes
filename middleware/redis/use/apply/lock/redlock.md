## redlock

### 问题

主节点加锁成功，尚未同步到从节点，主节点宕机，A抢到锁，B在从节点也抢到锁。

### 解决方式一

A抢到锁，将业务逻辑放入队列，B抢到锁，也把业务逻辑放到队列，谁先放进去，则业务属于谁。

### redlock算法

抢锁时，向多台没有主从关系的redis尝试加锁，比如9台，如果有5台以上加锁成功，则抢锁成功。

释放锁时，需要向所有机器释放锁。